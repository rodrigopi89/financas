<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Finan√ßas Inteligente</title>
    <style>
        :root {
            --green: #27ae60;
            --red: #e74c3c;
            --blue: #3498db;
            --dark: #2c3e50;
            --light: #f8f9fa;
        }
        body { font-family: -apple-system, sans-serif; background: var(--light); margin: 0; padding: 15px; color: var(--dark); padding-bottom: 50px; }
        .card { background: white; padding: 15px; border-radius: 15px; box-shadow: 0 4px 12px rgba(0,0,0,0.08); margin-bottom: 15px; }
        
        /* Resumo Topo */
        .balance-card { background: var(--dark); color: white; padding: 25px; border-radius: 20px; text-align: center; margin-bottom: 20px; }
        .balance-card .val { font-size: 2rem; font-weight: bold; margin-top: 5px; }

        /* Categorias R√°pidas */
        .category-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-bottom: 15px; }
        .cat-btn { 
            background: #fff; border: 1px solid #ddd; padding: 10px 5px; border-radius: 12px; 
            font-size: 0.8rem; cursor: pointer; display: flex; flex-direction: column; align-items: center; gap: 5px;
            transition: 0.2s;
        }
        .cat-btn:active { transform: scale(0.95); background: #eee; }
        .cat-btn i { font-size: 1.5rem; }

        /* Formu√°rio */
        .input-group { margin-bottom: 12px; }
        label { display: block; font-size: 0.8rem; margin-bottom: 5px; font-weight: bold; color: #666; }
        input, select { 
            width: 100%; padding: 14px; border: 1px solid #ddd; border-radius: 10px; 
            box-sizing: border-box; font-size: 1rem; background: #fdfdfd;
        }
        .amount-input { font-size: 1.5rem; font-weight: bold; color: var(--dark); text-align: center; border: 2px solid var(--blue); }

        .btn-main { 
            background: var(--blue); color: white; border: none; padding: 15px; 
            width: 100%; border-radius: 12px; font-weight: bold; font-size: 1rem; margin-top: 10px;
        }

        /* Lista de Transa√ß√µes */
        .list-item { 
            display: flex; justify-content: space-between; align-items: center; 
            padding: 12px; border-bottom: 1px solid #f1f1f1; 
        }
        .item-info b { display: block; font-size: 1rem; }
        .item-info span { font-size: 0.75rem; color: #999; }
        .val-in { color: var(--green); font-weight: bold; }
        .val-out { color: var(--red); font-weight: bold; }

        .tabs { display: flex; gap: 10px; margin-bottom: 20px; position: sticky; top: 0; background: var(--light); padding: 10px 0; z-index: 10; }
        .tab { flex: 1; padding: 10px; border-radius: 10px; border: none; background: #ddd; font-weight: bold; }
        .tab.active { background: var(--blue); color: white; }
        
        .section { display: none; }
        .section.active { display: block; }
    </style>
</head>
<body>

    <div class="balance-card">
        <div style="opacity: 0.8; font-size: 0.9rem;">Saldo Atual</div>
        <div class="val" id="total-balance">R$ 0,00</div>
    </div>

    <div class="tabs">
        <button class="tab active" onclick="setTab('add')">‚ûï Novo</button>
        <button class="tab" onclick="setTab('history')">üìú Extrato</button>
        <button class="tab" onclick="setTab('goals')">üê∑ Metas</button>
    </div>

    <!-- SE√á√ÉO ADICIONAR -->
    <div id="sec-add" class="section active">
        <div class="card">
            <label>Categorias R√°pidas</label>
            <div class="category-grid">
                <div class="cat-btn" onclick="quickFill('Sal√°rio', 'in', 'üí∞')"><i>üí∞</i>Sal√°rio</div>
                <div class="cat-btn" onclick="quickFill('Pix Recebido', 'in', 'üì±')"><i>üì±</i>Pix Rec.</div>
                <div class="cat-btn" onclick="quickFill('Aluguel', 'out', 'üè†')"><i>üè†</i>Aluguel</div>
                <div class="cat-btn" onclick="quickFill('√Ågua/Luz', 'out', 'üí°')"><i>üí°</i>Contas</div>
                <div class="cat-btn" onclick="quickFill('Cart√£o', 'out', 'üí≥')"><i>üí≥</i>Cart√£o</div>
                <div class="cat-btn" onclick="quickFill('Mercado', 'out', 'üõí')"><i>üõí</i>Mercado</div>
            </div>

            <div class="input-group">
                <label>Descri√ß√£o</label>
                <input type="text" id="desc" placeholder="Nome da transa√ß√£o" list="suggestions">
                <datalist id="suggestions">
                    <option value="Lanche">
                    <option value="Combust√≠vel">
                    <option value="Internet">
                    <option value="Farm√°cia">
                </datalist>
            </div>

            <div class="input-group">
                <label>Valor (R$)</label>
                <input type="number" id="amount" class="amount-input" placeholder="0,00" step="0.01" inputmode="decimal">
            </div>

            <div class="input-group">
                <label>Tipo</label>
                <select id="type">
                    <option value="out">Gasto (Sa√≠da)</option>
                    <option value="in">Ganho (Entrada)</option>
                </select>
            </div>

            <button class="btn-main" onclick="addTransaction()">Lan√ßar Transa√ß√£o</button>
        </div>
    </div>

    <!-- SE√á√ÉO HIST√ìRICO -->
    <div id="sec-history" class="section">
        <div class="card">
            <div id="transaction-list"></div>
        </div>
    </div>

    <!-- SE√á√ÉO METAS -->
    <div id="sec-goals" class="section">
        <div class="card">
            <label>Novo Cofrinho</label>
            <input type="text" id="goal-name" placeholder="Ex: Reserva, Celular...">
            <input type="number" id="goal-target" placeholder="Meta R$">
            <button class="btn-main" onclick="addGoal()" style="background: var(--green);">Criar Cofrinho</button>
        </div>
        <div id="goals-list"></div>
    </div>

    <script>
        let db = JSON.parse(localStorage.getItem('financasProDB')) || { transactions: [], goals: [] };

        function setTab(tab) {
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.getElementById('sec-' + tab).classList.add('active');
            event.currentTarget.classList.add('active');
        }

        function quickFill(name, type, icon) {
            document.getElementById('desc').value = name;
            document.getElementById('type').value = type;
            // Feedback visual r√°pido
            const btn = event.currentTarget;
            btn.style.background = "#e1f5fe";
            setTimeout(() => btn.style.background = "#fff", 200);
        }

        function addTransaction() {
            const desc = document.getElementById('desc').value;
            const amount = parseFloat(document.getElementById('amount').value);
            const type = document.getElementById('type').value;

            if (!desc || !amount) {
                alert("Por favor, preencha descri√ß√£o e valor!");
                return;
            }

            db.transactions.push({
                desc, amount, type,
                date: new Date().toLocaleDateString('pt-BR', {day:'2-digit', month:'2-digit'})
            });

            saveAndRefresh();
            document.getElementById('desc').value = "";
            document.getElementById('amount').value = "";
            setTab('history');
        }

        function saveAndRefresh() {
            localStorage.setItem('financasProDB', JSON.stringify(db));
            render();
        }

        function deleteTransaction(index) {
            if(confirm("Excluir esta transa√ß√£o?")) {
                db.transactions.splice(index, 1);
                saveAndRefresh();
            }
        }

        function render() {
            // Atualiza Saldo
            const totalIn = db.transactions.filter(t => t.type === 'in').reduce((a, b) => a + b.amount, 0);
            const totalOut = db.transactions.filter(t => t.type === 'out').reduce((a, b) => a + b.amount, 0);
            const balance = totalIn - totalOut;
            
            document.getElementById('total-balance').innerText = balance.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });

            // Renderiza Lista
            const list = document.getElementById('transaction-list');
            if(db.transactions.length === 0) {
                list.innerHTML = "<p style='text-align:center; color:#999'>Nenhuma transa√ß√£o.</p>";
            } else {
                list.innerHTML = db.transactions.map((t, i) => `
                    <div class="list-item">
                        <div class="item-info">
                            <b>${t.desc}</b>
                            <span>${t.date}</span>
                        </div>
                        <div style="display:flex; align-items:center; gap:12px">
                            <span class="${t.type === 'in' ? 'val-in' : 'val-out'}">
                                ${t.type === 'in' ? '+' : '-'} ${t.amount.toLocaleString('pt-BR', {minimumFractionDigits:2})}
                            </span>
                            <button onclick="deleteTransaction(${i})" style="border:none; background:none; color:#ccc; font-size:1.2rem">‚úï</button>
                        </div>
                    </div>
                `).reverse().join('');
            }

            // Renderiza Cofrinhos (Metas)
            const goalsList = document.getElementById('goals-list');
            goalsList.innerHTML = db.goals.map((g, i) => {
                const perc = Math.min((g.current / g.target) * 100, 100);
                return `
                    <div class="card">
                        <div style="display:flex; justify-content:space-between; font-weight:bold; margin-bottom:10px">
                            <span>${g.name}</span>
                            <span>${perc.toFixed(0)}%</span>
                        </div>
                        <div style="background:#eee; height:10px; border-radius:5px; overflow:hidden">
                            <div style="background:var(--green); width:${perc}%; height:100%"></div>
                        </div>
                        <div style="display:flex; justify-content:space-between; margin-top:10px; font-size:0.9rem">
                            <span>R$ ${g.current} de R$ ${g.target}</span>
                            <button onclick="addMoneyGoal(${i})" style="padding:5px 10px; border-radius:5px; border:none; background:var(--blue); color:#white">+ R$</button>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function addGoal() {
            const name = document.getElementById('goal-name').value;
            const target = parseFloat(document.getElementById('goal-target').value);
            if(name && target) {
                db.goals.push({name, target, current: 0});
                document.getElementById('goal-name').value = "";
                document.getElementById('goal-target').value = "";
                saveAndRefresh();
            }
        }

        function addMoneyGoal(index) {
            const val = parseFloat(prompt("Quanto deseja depositar?"));
            if(val) {
                db.goals[index].current += val;
                saveAndRefresh();
            }
        }

        render();
    </script>
</body>
</html>
